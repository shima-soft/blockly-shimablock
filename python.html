<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ShimaBlock for Python</title>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-378735-20"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-378735-20');
</script>
<script src="closure/goog/base.js"></script>
<script src="blockly_compressed.js"></script>
<script src="blocks_compressed.js"></script>
<script src="msg/js/ja.js"></script>
<script src="blocks/selenium.js"></script>
<script src="generators/python.js"></script>
<script src="generators/python/colour.js"></script>
<script src="generators/python/lists.js"></script>
<script src="generators/python/logic.js"></script>
<script src="generators/python/loops.js"></script>
<script src="generators/python/math.js"></script>
<script src="generators/python/procedures.js"></script>
<script src="generators/python/selenium.js"></script>
<script src="generators/python/text.js"></script>
<script src="generators/python/variables.js"></script>
<script src="generators/python/variables_dynamic.js"></script>
<script src="main.js"></script>
</head>
<body>
<table width="100%">
  <tbody>
    <tr>
      <td width="70%">
        <table width="100%">
          <tbody>
            <tr>
              <td nowrap="nowrap">ShimaBlock for Python (構築中)</td>
              <td width="100%" style="text-align: center;">プロジェクト名：<input id="project_name" tyep="text" value="Main" onchange="setProcedureName();"></td>
              <td nowrap="nowrap">
                <input type="button" value="ホーム" onclick="location.href='index.html';">
                <input type="button" value="開く" onclick="document.getElementById('loadButton').click();">
                <input type="button" value="保存" onclick="document.getElementById('download').click();">
                <input type="button" value="リセット" onclick="workspace.clear();">
                <input id="loadButton" type="file" onchange="readXmlToWorkspace(this)" style="display: none;">
                <a id="download" href="#" download="download.xml" onclick="downloadXml();" style="display: none;">download</a>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td width="30%">Excel VBA <button onclick="codeCopy();">codeCopy</button></td>
    </tr>
    <tr>
      <td nowrap="nowrap"><div id="blocklyDiv" style="height: 800px; width: 100%;"></div></td>
      <td nowrap="nowrap"><textarea id="codeOutput" style="height: 800px; width: 100%;" wrap="off" readonly></textarea></td>
    </tr>
  </tbody>
</table>

<div>importExport</div><button onclick="toXml();">toXml</button><button onclick="fromXml();">fromXml</button>
<textarea id="importExport" style="height: 600px; width: 100%;" readonly></textarea>
<xml id="toolbox" style="display: none">
  <category name="条件" colour="210">
    <block type="controls_if"></block>
    <block type="logic_compare">
      <field name="OP">EQ</field>
    </block>
    <block type="logic_operation">
      <field name="OP">AND</field>
    </block>
    <block type="logic_negate"></block>
    <block type="logic_boolean">
      <field name="BOOL">TRUE</field>
    </block>
    <block type="logic_null"></block>
    <block type="logic_ternary"></block>
  </category>
  <category name="繰り返し" colour="120">
    <block type="controls_repeat_ext">
      <value name="TIMES">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
    </block>
    <block type="controls_whileUntil">
      <field name="MODE">WHILE</field>
    </block>
    <block type="controls_for">
      <field name="VAR" id="]?Jx3.x[BnSGX.0)}79m">i</field>
      <value name="FROM">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="TO">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
      <value name="BY">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
    </block>
    <block type="controls_forEach">
      <field name="VAR" id="a8-7Q|duk/,QhY5n8e}7">j</field>
    </block>
    <block type="controls_flow_statements">
      <field name="FLOW">BREAK</field>
    </block>
  </category>
  <category name="数値" colour="230">
    <block type="math_number">
      <field name="NUM">0</field>
    </block>
    <block type="math_arithmetic">
      <field name="OP">ADD</field>
      <value name="A">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="B">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
    </block>
    <block type="math_single">
      <field name="OP">ROOT</field>
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM">9</field>
        </shadow>
      </value>
    </block>
    <block type="math_trig">
      <field name="OP">SIN</field>
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM">45</field>
        </shadow>
      </value>
    </block>
    <block type="math_constant">
      <field name="CONSTANT">PI</field>
    </block>
    <block type="math_number_property">
      <mutation divisor_input="false"></mutation>
      <field name="PROPERTY">EVEN</field>
      <value name="NUMBER_TO_CHECK">
        <shadow type="math_number">
          <field name="NUM">0</field>
        </shadow>
      </value>
    </block>
    <block type="math_round">
      <field name="OP">ROUND</field>
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM">3.1</field>
        </shadow>
      </value>
    </block>
    <block type="math_on_list">
      <mutation op="SUM"></mutation>
      <field name="OP">SUM</field>
    </block>
    <block type="math_modulo">
      <value name="DIVIDEND">
        <shadow type="math_number">
          <field name="NUM">64</field>
        </shadow>
      </value>
      <value name="DIVISOR">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
    </block>
    <block type="math_constrain">
      <value name="VALUE">
        <shadow type="math_number">
          <field name="NUM">50</field>
        </shadow>
      </value>
      <value name="LOW">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="HIGH">
        <shadow type="math_number">
          <field name="NUM">100</field>
        </shadow>
      </value>
    </block>
    <block type="math_random_int">
      <value name="FROM">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="TO">
        <shadow type="math_number">
          <field name="NUM">100</field>
        </shadow>
      </value>
    </block>
    <block type="math_random_float"></block>
  </category>
  <category name="テキスト" colour="210">
    <block type="text">
      <field name="TEXT"></field>
    </block>
    <block type="text_join">
      <mutation items="2"></mutation>
    </block>
    <block type="text_append">
      <field name="VAR" id="S7umDfecO+W)K8(ENT*2">item</field>
      <value name="TEXT">
        <shadow type="text">
          <field name="TEXT"></field>
        </shadow>
      </value>
    </block>
    <block type="text_length">
      <value name="VALUE">
        <shadow type="text">
          <field name="TEXT">abc</field>
        </shadow>
      </value>
    </block>
    <block type="text_isEmpty">
      <value name="VALUE">
        <shadow type="text">
          <field name="TEXT"></field>
        </shadow>
      </value>
    </block>
    <block type="text_indexOf">
      <field name="END">FIRST</field>
      <value name="VALUE">
        <block type="variables_get">
          <field name="VAR" id="G!f1t?eMNn/lSCA0`x^V">text</field>
        </block>
      </value>
      <value name="FIND">
        <shadow type="text">
          <field name="TEXT">abc</field>
        </shadow>
      </value>
    </block>
    <block type="text_charAt">
      <mutation at="true"></mutation>
      <field name="WHERE">FROM_START</field>
      <value name="VALUE">
        <block type="variables_get">
          <field name="VAR" id="G!f1t?eMNn/lSCA0`x^V">text</field>
        </block>
      </value>
    </block>
    <block type="text_getSubstring">
      <mutation at1="true" at2="true"></mutation>
      <field name="WHERE1">FROM_START</field>
      <field name="WHERE2">FROM_START</field>
      <value name="STRING">
        <block type="variables_get">
          <field name="VAR" id="G!f1t?eMNn/lSCA0`x^V">text</field>
        </block>
      </value>
    </block>
    <block type="text_changeCase">
      <field name="CASE">UPPERCASE</field>
      <value name="TEXT">
        <shadow type="text">
          <field name="TEXT">abc</field>
        </shadow>
      </value>
    </block>
    <block type="text_trim">
      <field name="MODE">BOTH</field>
      <value name="TEXT">
        <shadow type="text">
          <field name="TEXT">abc</field>
        </shadow>
      </value>
    </block>
    <block type="text_print">
      <value name="TEXT">
        <shadow type="text">
          <field name="TEXT">abc</field>
        </shadow>
      </value>
    </block>
    <block type="text_prompt_ext">
      <mutation type="TEXT"></mutation>
      <field name="TYPE">TEXT</field>
      <value name="TEXT">
        <shadow type="text">
          <field name="TEXT">abc</field>
        </shadow>
      </value>
    </block>
  </category>
  <category name="リスト" colour="#745ba5">
    <block type="lists_create_with">
      <mutation items="0"></mutation>
    </block>
    <block type="lists_create_with">
      <mutation items="3"></mutation>
    </block>
    <block type="lists_repeat">
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM">5</field>
        </shadow>
      </value>
    </block>
    <block type="lists_length"></block>
    <block type="lists_isEmpty"></block>
    <block type="lists_indexOf">
      <field name="END">FIRST</field>
      <value name="VALUE">
        <block type="variables_get">
          <field name="VAR" id="3S#lu,9q;T^B42N~_wzC">list</field>
        </block>
      </value>
    </block>
    <block type="lists_getIndex">
      <mutation statement="false" at="true"></mutation>
      <field name="MODE">GET</field>
      <field name="WHERE">FROM_START</field>
      <value name="VALUE">
        <block type="variables_get">
          <field name="VAR" id="3S#lu,9q;T^B42N~_wzC">list</field>
        </block>
      </value>
    </block>
    <block type="lists_setIndex">
      <mutation at="true"></mutation>
      <field name="MODE">SET</field>
      <field name="WHERE">FROM_START</field>
      <value name="LIST">
        <block type="variables_get">
          <field name="VAR" id="3S#lu,9q;T^B42N~_wzC">list</field>
        </block>
      </value>
    </block>
    <block type="lists_getSublist">
      <mutation at1="true" at2="true"></mutation>
      <field name="WHERE1">FROM_START</field>
      <field name="WHERE2">FROM_START</field>
      <value name="LIST">
        <block type="variables_get">
          <field name="VAR" id="3S#lu,9q;T^B42N~_wzC">list</field>
        </block>
      </value>
    </block>
    <block type="lists_split">
      <mutation mode="SPLIT"></mutation>
      <field name="MODE">SPLIT</field>
      <value name="DELIM">
        <shadow type="text">
          <field name="TEXT">,</field>
        </shadow>
      </value>
    </block>
    <block type="lists_sort">
      <field name="TYPE">NUMERIC</field>
      <field name="DIRECTION">1</field>
    </block>
  </category>
  <category name="色" colour="#a5745b">
    <block type="colour_picker">
      <field name="COLOUR">#ff0000</field>
    </block>
    <block type="colour_random"></block>
    <block type="colour_rgb">
      <value name="RED">
        <shadow type="math_number">
          <field name="NUM">100</field>
        </shadow>
      </value>
      <value name="GREEN">
        <shadow type="math_number">
          <field name="NUM">50</field>
        </shadow>
      </value>
      <value name="BLUE">
        <shadow type="math_number">
          <field name="NUM">0</field>
        </shadow>
      </value>
    </block>
    <block type="colour_blend">
      <value name="COLOUR1">
        <shadow type="colour_picker">
          <field name="COLOUR">#ff0000</field>
        </shadow>
      </value>
      <value name="COLOUR2">
        <shadow type="colour_picker">
          <field name="COLOUR">#3333ff</field>
        </shadow>
      </value>
      <value name="RATIO">
        <shadow type="math_number">
          <field name="NUM">0.5</field>
        </shadow>
      </value>
    </block>
  </category>
  <sep></sep>
  <category name="Selenium" colour="180">
    <category name="ブラウザ" colour="180">
      <label text="ブラウザ変数"></label>
      <button text="ブラウザ変数を作成…" callbackKey="createVariableDriver"></button>
      <block type="browser_var_set"></block>
      <block type="browser_var_get"></block>  
      <label text="操作ブロック"></label>
      <block type="browser_method"></block>
      <block type="browser_method_get"></block>
      <label text="取得ブロック"></label>
      <block type="browser_get"></block>
      <block type="browser_get_find_element_by"></block>
      <block type="browser_get_find_elements_by"></block>
      <block type="browser_method_get_screenshot_as_file"></block>
      <label text="設定ブロック"></label>
      <block type="browser_set_window_size"></block>
      <block type="browser_set_window_position"></block>
      <block type="browser_set_script_timeout"></block>
      <block type="browser_set_page_load_timeout"></block>
    </category>
    <category name="クッキー" colour="180">
      <label text="操作ブロック"></label>
      <block type="browser_method_add_cookie"></block>
      <block type="browser_method_delete_all_cookies"></block>
      <block type="browser_method_delete_cookie"></block>
      <label text="取得ブロック"></label>
      <block type="browser_get_cookies"></block>
      <block type="browser_get_cookie"></block>
    </category>
    <category name="要素" colour="90">
      <label text="要素変数"></label>
      <button text="要素変数を作成…" callbackKey="createVariableDriver"></button>
      <block type="element_var_set"></block>
      <block type="element_var_get"></block>  
      <label text="操作ブロック"></label>
      <block type="element_method"></block>
      <block type="element_method_send_keys"></block>
      <block type="element_method_screenshot"></block>
      <label text="取得ブロック"></label>
      <block type="element_get_find_element_by"></block>
      <block type="element_get_find_elements_by"></block>
      <block type="element_get_text"></block>
      <block type="element_get_arg0"></block>
      <block type="element_get"></block>
      <label text="状態取得ブロック"></label>
      <block type="element_is"></block>
    </category>
  </category>
  
  <sep></sep>
  <category name="変数" colour="330" custom="VARIABLE"></category>
  <category name="関数" colour="#995ba5" custom="PROCEDURE"></category>
</xml>
<script>
var workspace = Blockly.inject('blocklyDiv',
    {toolbox: document.getElementById('toolbox'),
     zoom:
         {controls: true,
          wheel: false,
          startScale: 1.0,
          maxScale: 3,
          minScale: 0.3,
          scaleSpeed: 1.2,
          pinch: true},
          grid:
         {spacing: 20,
          length: 3,
          colour: '#ccc',
          snap: true},
     trashcan: true});
workspace.addChangeListener(function() {
  const codebox = document.getElementById("codeOutput");
  const code = Blockly.Python.workspaceToCode(workspace);
  codebox.value = code;
});
workspace.registerButtonCallback('createVariableDriver', function(button){
  Blockly.Variables.createVariableButtonHandler(button.getTargetWorkspace(), null, 'driver');
});
workspace.registerButtonCallback('createVariableWorksheet', function(button){
  Blockly.Variables.createVariableButtonHandler(button.getTargetWorkspace(), null, 'element');
});
</script>
<script>
  function toXml() {
    var xml = Blockly.Xml.workspaceToDom(workspace);
    var xml_text = Blockly.Xml.domToPrettyText(xml);
    var output = document.getElementById('importExport');
    output.value = xml_text;
  }
  function fromXml() {
  var input = document.getElementById('importExport');
  if (!input.value) {
    return;
  }
  var xml = Blockly.Xml.textToDom(input.value);
  Blockly.Xml.domToWorkspace(xml, workspace);
  }
  function codeCopy() {
    var code = document.getElementById('codeOutput');
    code.select();
    document.execCommand("copy");
  }
</script>
</body>
</html>

